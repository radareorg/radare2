NAME=Basic op types working, even at EOF
FILE=malloc://73
CMDS=<<EOF
e asm.arch=pickle
wx+284b424d42414a44434241954746454443424100550055044142434442040000
wx+00414243448d0400000000000000414243444c3334354c0a63414243440a4546
wx+47480a550441424344
s-73
pid 12
EOF
EXPECT=<<EOF
0x00000000                   28  MARK
0x00000001                 4b42  BININT1 0x42
0x00000003               4d4241  BININT2 0x4142
0x00000006           4a44434241  BININT 0x41424344
0x0000000b   954746454443424100  FRAME 0x41424344454647
0x00000014                 5500  SHORT_BINSTRING ""
0x00000016         550441424344  SHORT_BINSTRING "ABCD"
0x0000001c   420400000041424344  BINBYTES "ABCD"
0x00000025 8d040000000000000041424344  BINUNICODE8 "ABCD"
0x00000032         4c3334354c0a  LONG "345L"
0x00000038 63414243440a454647480a  GLOBAL "ABCD EFGH"
0x00000043         550441424344  SHORT_BINSTRING "ABCD"
EOF
RUN

NAME=Invalid/filtered string ops
FILE=malloc://16
CMDS=<<EOF
e asm.arch=pickle
wx+585804000000414200436341000a4344
s 0
pid 8
EOF
EXPECT=<<EOF
0x00000000                   58  
0x00000001   580400000041420043  BINUNICODE "AB\x00C"
0x0000000a                   63  
0x0000000b                   41  
0x0000000c                   00  
0x0000000d                   0a  
0x0000000e                   43  
0x0000000f                   44  
EOF
RUN
