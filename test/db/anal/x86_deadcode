NAME=antidisasm deadcode jcc pair
FILE=hex://557403750121b821000000cd80c3
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
e scr.color=0
e scr.utf8=0
e asm.emu=false
e anal.jmp.pair=false
af @ 0
agf
?e
e anal.jmp.pair=true
af-*
af @ 0
agf
EOF
EXPECT=<<EOF
                         .----------------------------------.
                         |  0x0                             |
                         | 19: fcn.00000000 (int64_t arg1); |
                         | `- args(rdi)                     |
                         | push rbp                         |
                         | je 6                             |
                         `----------------------------------'
                                 f t
                                 | |
                                 | '-----------------.
                          .------'                   |
                          |                          |
                      .--------------------.         |
                      |  0x3               |         |
                      | jne 6              |         |
                      `--------------------'         |
                              f t                    |
                              | |                    |
                              | '-----------.        |
    .-------------------------'             |        |
    |                                       | .------'
    |                                       | |
.--------------------------------.    .--------------------.
|  0x5                           |    |  0x6               |
| ; arg1                         |    | ; '!'              |
| and dword [rax + 0x21], edi    |    | ; 33               |
`--------------------------------'    | mov eax, 0x21      |
    v                                 `--------------------'
    |                                     v
    |                                     |
    '-----------------------.             |
                            | .-----------'
                            | |
                      .--------------------.
                      |  0xb               |
                      | int 0x80           |
                      | ret                |
                      `--------------------'

.----------------------.
|  0x0                 |
| 11: fcn.00000000 (); |
| push rbp             |
| je 6                 |
`----------------------'
    v
    |
    '.
     |
 .--------------------.
 |  0x6               |
 | ; '!'              |
 | ; 33               |
 | mov eax, 0x21      |
 | int 0x80           |
 | ret                |
 `--------------------'
EOF
RUN
