NAME=sBPF: Segments with custom base address 0x10000000
FILE=bins/elf/sbpf_example.so
ARGS=-B 0x10000000
CMDS=<<EOF
iSS
EOF
EXPECT=<<EOF
nth paddr          size vaddr         vsize perm flags type name
----------------------------------------------------------------
0   0x00000120  0x29818 0x10000120  0x29818 -r-x 0x0   MAP  LOAD0
1   0x00029938   0x4f48 0x10029938   0x4f48 -rw- 0x0   MAP  LOAD1
2   0x0002e930   0x44a8 0x1002e930   0x44a8 -r-- 0x0   MAP  LOAD2
3   0x0002e880     0xb0 0x1002e880     0xb0 -rw- 0x0   MAP  DYNAMIC
4   0x00000000     0x40 0x10000000     0x40 -rw- 0x0   MAP  ehdr
EOF
RUN

NAME=sBPF: Verify relocations are present
FILE=bins/elf/sbpf_example.so
ARGS=-B 0x10000000
CMDS=<<EOF
ir | head -10
EOF
EXPECT=<<EOF
vaddr      paddr      type   ntype name
---------------------------------------
0x100003d0 0x000003d0 SET_64 8
0x10000408 0x00000408 SET_64 8
0x10000460 0x00000460 SET_64 8
0x10000620 0x00000620 SET_64 8
0x10000800 0x00000800 SET_64 8
0x10000838 0x00000838 SET_64 8
0x10000890 0x00000890 SET_64 8
0x10000cd8 0x00000cd8 SET_64 8
EOF
RUN
