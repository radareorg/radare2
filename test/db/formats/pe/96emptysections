NAME=PE: corkami 96emptysections.exe - open and analyse
FILE=bins/pe/96emptysections.exe
ARGS=-A
CMDS=q!
EXPECT=<<EOF
EOF
RUN

NAME=PE: corkami 96emptysections.exe - entrypoint
FILE=bins/pe/96emptysections.exe
CMDS=s
EXPECT=<<EOF
0x402000
EOF
RUN

NAME=PE: corkami 96emptysections.exe - entrypoint pif
BROKEN=1
FILE=bins/pe/96emptysections.exe
CMDS=<<EOF
aaa
pif @ entry0
EOF
EXPECT=<<EOF
push 0x402028
call sub.msvcrt.dll_printf_18
add esp, 4
push 0
call sub.kernel32.dll_ExitProcess_1e
EOF
RUN

NAME=PE: corkami 96workingsections.exe - sections list
FILE=bins/pe/96emptysections.exe
ARGS=-n
CMDS=!rabin2 -pS bins/pe/96emptysections.exe
EXPECT=<<EOF
[Sections]

nth paddr        size vaddr        vsize perm type name
-------------------------------------------------------
0   0x00001200  0x200 0x00001200  0x1000 -rwx ---- sect_0
1   0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_1
2   0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_2
3   0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_3
4   0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_4
5   0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_5
6   0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_6
7   0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_7
8   0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_8
9   0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_9
10  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_10
11  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_11
12  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_12
13  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_13
14  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_14
15  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_15
16  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_16
17  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_17
18  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_18
19  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_19
20  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_20
21  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_21
22  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_22
23  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_23
24  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_24
25  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_25
26  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_26
27  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_27
28  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_28
29  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_29
30  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_30
31  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_31
32  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_32
33  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_33
34  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_34
35  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_35
36  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_36
37  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_37
38  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_38
39  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_39
40  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_40
41  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_41
42  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_42
43  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_43
44  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_44
45  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_45
46  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_46
47  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_47
48  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_48
49  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_49
50  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_50
51  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_51
52  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_52
53  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_53
54  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_54
55  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_55
56  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_56
57  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_57
58  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_58
59  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_59
60  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_60
61  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_61
62  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_62
63  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_63
64  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_64
65  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_65
66  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_66
67  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_67
68  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_68
69  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_69
70  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_70
71  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_71
72  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_72
73  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_73
74  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_74
75  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_75
76  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_76
77  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_77
78  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_78
79  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_79
80  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_80
81  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_81
82  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_82
83  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_83
84  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_84
85  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_85
86  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_86
87  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_87
88  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_88
89  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_89
90  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_90
91  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_91
92  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_92
93  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_93
94  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_94
95  0x00000000    0x0 0x00000000  0x1000 ---- ---- sect_95

EOF
RUN
