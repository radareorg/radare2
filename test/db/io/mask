NAME=iomask
FILE=bins/elf/hello_world
ARGS=-n -e io.mask=0xf
CMDS=<<EOF
x 32
s+2
x 64
EOF
EXPECT=<<EOF
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF............
0x00000010  7f45 4c46 0201 0100 0000 0000 0000 0000  .ELF............
- offset -   2 3  4 5  6 7  8 9  A B  C D  E F 1011  23456789ABCDEF01
0x00000002  4c46 0201 0100 0000 0000 0000 0000 7f45  LF.............E
0x00000012  4c46 0201 0100 0000 0000 0000 0000 7f45  LF.............E
0x00000022  4c46 0201 0100 0000 0000 0000 0000 7f45  LF.............E
0x00000032  4c46 0201 0100 0000 0000 0000 0000 7f45  LF.............E
EOF
RUN

NAME=iomask2
FILE=--
CMDS=<<EOF
e io.mask=0x20-1
o malloc://0x10
w hello
o malloc://0x10 0x10
w world @ 0x10
x 0x20 @ 0
e io.mask=0x10-1
x 0x20 @ 0
EOF
EXPECT=<<EOF
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  6865 6c6c 6f00 0000 0000 0000 0000 0000  hello...........
0x00000010  776f 726c 6400 0000 0000 0000 0000 0000  world...........
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  6865 6c6c 6f00 0000 0000 0000 0000 0000  hello...........
0x00000010  6865 6c6c 6f00 0000 0000 0000 0000 0000  hello...........
EOF
RUN

