NAME=macho relocs
BROKEN=1
FILE=bins/mach0/ls-m1
CMDS=<<EOF
x 32 @ 0x1000081d8
wc
EOF
EXPECT=<<EOF
- offset -   D8D9 DADB DCDD DEDF E0E1 E2E3 E4E5 E6E7  89ABCDEF01234567
0x1000081d8  4500 0000 0000 09c0 4600 0000 0000 09c0  E.......F.......
0x1000081e8  4700 0000 0000 09c0 4800 0000 0000 09c0  G.......H.......
EOF
RUN

NAME=macho relocs bin.cache
BROKEN=1
FILE=bins/mach0/ls-m1
ARGS=-e bin.cache=true
CMDS=<<EOF
x 32 @ 0x1000081d8
wc
EOF
EXPECT=<<EOF
- offset -   D8D9 DADB DCDD DEDF E0E1 E2E3 E4E5 E6E7  89ABCDEF01234567
0x1000081d8  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x1000081e8  0000 0000 0000 0000 0000 0000 0000 0000  ................
idx=0 addr=0x100008000 size=8 06000000000009c0 -> 0000000000000000 (not written)
idx=1 addr=0x100008008 size=8 07000000000009c0 -> 0000000000000000 (not written)
idx=2 addr=0x100008010 size=8 08000000000009c0 -> 0000000000000000 (not written)
idx=3 addr=0x100008018 size=8 09000000000009c0 -> 0000000000000000 (not written)
idx=4 addr=0x100008020 size=8 0d000000000009c0 -> 0000000000000000 (not written)
idx=5 addr=0x100008028 size=8 0e000000000009c0 -> 0000000000000000 (not written)
idx=6 addr=0x100008030 size=8 0f000000000009c0 -> 0000000000000000 (not written)
idx=7 addr=0x100008038 size=8 10000000000009c0 -> 0000000000000000 (not written)
idx=8 addr=0x100008040 size=8 11000000000009c0 -> 0000000000000000 (not written)
idx=9 addr=0x100008048 size=8 12000000000009c0 -> 0000000000000000 (not written)
idx=10 addr=0x100008050 size=8 13000000000009c0 -> 0000000000000000 (not written)
idx=11 addr=0x100008058 size=8 14000000000009c0 -> 0000000000000000 (not written)
idx=12 addr=0x100008060 size=8 15000000000009c0 -> 0000000000000000 (not written)
idx=13 addr=0x100008068 size=8 16000000000009c0 -> 0000000000000000 (not written)
idx=14 addr=0x100008070 size=8 17000000000009c0 -> 0000000000000000 (not written)
idx=15 addr=0x100008078 size=8 18000000000009c0 -> 0000000000000000 (not written)
idx=16 addr=0x100008080 size=8 19000000000009c0 -> 0000000000000000 (not written)
idx=17 addr=0x100008088 size=8 1a000000000009c0 -> 0000000000000000 (not written)
idx=18 addr=0x100008090 size=8 1b000000000009c0 -> 0000000000000000 (not written)
idx=19 addr=0x100008098 size=8 1c000000000009c0 -> 0000000000000000 (not written)
idx=20 addr=0x1000080a0 size=8 1d000000000009c0 -> 0000000000000000 (not written)
idx=21 addr=0x1000080a8 size=8 1e000000000009c0 -> 0000000000000000 (not written)
idx=22 addr=0x1000080b0 size=8 1f000000000009c0 -> 0000000000000000 (not written)
idx=23 addr=0x1000080b8 size=8 20000000000009c0 -> 0000000000000000 (not written)
idx=24 addr=0x1000080c0 size=8 21000000000009c0 -> 0000000000000000 (not written)
idx=25 addr=0x1000080c8 size=8 22000000000009c0 -> 0000000000000000 (not written)
idx=26 addr=0x1000080d0 size=8 23000000000009c0 -> 0000000000000000 (not written)
idx=27 addr=0x1000080d8 size=8 24000000000009c0 -> 0000000000000000 (not written)
idx=28 addr=0x1000080e0 size=8 25000000000009c0 -> 0000000000000000 (not written)
idx=29 addr=0x1000080e8 size=8 26000000000009c0 -> 0000000000000000 (not written)
idx=30 addr=0x1000080f0 size=8 27000000000009c0 -> 0000000000000000 (not written)
idx=31 addr=0x1000080f8 size=8 28000000000009c0 -> 0000000000000000 (not written)
idx=32 addr=0x100008100 size=8 29000000000009c0 -> 0000000000000000 (not written)
idx=33 addr=0x100008108 size=8 2a000000000009c0 -> 0000000000000000 (not written)
idx=34 addr=0x100008110 size=8 2b000000000009c0 -> 0000000000000000 (not written)
idx=35 addr=0x100008118 size=8 2c000000000009c0 -> 0000000000000000 (not written)
idx=36 addr=0x100008120 size=8 2d000000000009c0 -> 0000000000000000 (not written)
idx=37 addr=0x100008128 size=8 2e000000000009c0 -> 0000000000000000 (not written)
idx=38 addr=0x100008130 size=8 00000000000009c0 -> 0000000000000000 (not written)
idx=39 addr=0x100008138 size=8 2f000000000009c0 -> 0000000000000000 (not written)
idx=40 addr=0x100008140 size=8 30000000000009c0 -> 0000000000000000 (not written)
idx=41 addr=0x100008148 size=8 31000000000009c0 -> 0000000000000000 (not written)
idx=42 addr=0x100008150 size=8 32000000000009c0 -> 0000000000000000 (not written)
idx=43 addr=0x100008158 size=8 33000000000009c0 -> 0000000000000000 (not written)
idx=44 addr=0x100008160 size=8 34000000000009c0 -> 0000000000000000 (not written)
idx=45 addr=0x100008168 size=8 35000000000009c0 -> 0000000000000000 (not written)
idx=46 addr=0x100008170 size=8 36000000000009c0 -> 0000000000000000 (not written)
idx=47 addr=0x100008178 size=8 37000000000009c0 -> 0000000000000000 (not written)
idx=48 addr=0x100008180 size=8 38000000000009c0 -> 0000000000000000 (not written)
idx=49 addr=0x100008188 size=8 3b000000000009c0 -> 0000000000000000 (not written)
idx=50 addr=0x100008190 size=8 3c000000000009c0 -> 0000000000000000 (not written)
idx=51 addr=0x100008198 size=8 3d000000000009c0 -> 0000000000000000 (not written)
idx=52 addr=0x1000081a0 size=8 3e000000000009c0 -> 0000000000000000 (not written)
idx=53 addr=0x1000081a8 size=8 3f000000000009c0 -> 0000000000000000 (not written)
idx=54 addr=0x1000081b0 size=8 40000000000009c0 -> 0000000000000000 (not written)
idx=55 addr=0x1000081b8 size=8 41000000000009c0 -> 0000000000000000 (not written)
idx=56 addr=0x1000081c0 size=8 42000000000009c0 -> 0000000000000000 (not written)
idx=57 addr=0x1000081c8 size=8 43000000000009c0 -> 0000000000000000 (not written)
idx=58 addr=0x1000081d0 size=8 44000000000009c0 -> 0000000000000000 (not written)
idx=59 addr=0x1000081d8 size=8 45000000000009c0 -> 0000000000000000 (not written)
idx=60 addr=0x1000081e0 size=8 46000000000009c0 -> 0000000000000000 (not written)
idx=61 addr=0x1000081e8 size=8 47000000000009c0 -> 0000000000000000 (not written)
idx=62 addr=0x1000081f0 size=8 48000000000009c0 -> 0000000000000000 (not written)
idx=63 addr=0x1000081f8 size=8 49000000000009c0 -> 0000000000000000 (not written)
idx=64 addr=0x100008200 size=8 4a000000000009c0 -> 0000000000000000 (not written)
idx=65 addr=0x100008208 size=8 4b000000000009c0 -> 0000000000000000 (not written)
idx=66 addr=0x100008210 size=8 4c000000000009c0 -> 0000000000000000 (not written)
idx=67 addr=0x100008218 size=8 4d000000000009c0 -> 0000000000000000 (not written)
idx=68 addr=0x100008220 size=8 4e000000000009c0 -> 0000000000000000 (not written)
idx=69 addr=0x100008228 size=8 4f000000000009c0 -> 0000000000000000 (not written)
idx=70 addr=0x100008230 size=8 50000000000009c0 -> 0000000000000000 (not written)
idx=71 addr=0x100008238 size=8 01000000000009c0 -> 0000000000000000 (not written)
idx=72 addr=0x100008240 size=8 02000000000009c0 -> 0000000000000000 (not written)
idx=73 addr=0x100008248 size=8 03000000000009c0 -> 0000000000000000 (not written)
idx=74 addr=0x100008250 size=8 51000000000009c0 -> 0000000000000000 (not written)
idx=75 addr=0x100008258 size=8 04000000000009c0 -> 0000000000000000 (not written)
idx=76 addr=0x100008260 size=8 52000000000009c0 -> 0000000000000000 (not written)
idx=77 addr=0x100008268 size=8 53000000000009c0 -> 0000000000000000 (not written)
idx=78 addr=0x100008270 size=8 54000000000009c0 -> 0000000000000000 (not written)
idx=79 addr=0x100008278 size=8 55000000000009c0 -> 0000000000000000 (not written)
idx=80 addr=0x100008280 size=8 56000000000009c0 -> 0000000000000000 (not written)
idx=81 addr=0x100008288 size=8 57000000000009c0 -> 0000000000000000 (not written)
idx=82 addr=0x100008290 size=8 0500000000000840 -> 0000000000000000 (not written)
idx=83 addr=0x100008298 size=8 0a00000000000840 -> 0000000000000000 (not written)
idx=84 addr=0x1000082a0 size=8 0b00000000000840 -> 0000000000000000 (not written)
idx=85 addr=0x1000082a8 size=8 0c00000000000840 -> 0000000000000000 (not written)
idx=86 addr=0x1000082b0 size=8 3900000000000840 -> 0000000000000000 (not written)
idx=87 addr=0x1000082b8 size=8 3a00000000000840 -> 0000000000000000 (not written)
idx=88 addr=0x1000082c0 size=8 347b000001004800 -> 347b000001000000 (not written)
idx=89 addr=0x100008308 size=8 4c7d000001001800 -> 4c7d000001000000 (not written)
idx=90 addr=0x100008320 size=8 517d000001001800 -> 517d000001000000 (not written)
idx=91 addr=0x100008338 size=8 567d000001001800 -> 567d000001000000 (not written)
idx=92 addr=0x100008350 size=8 5c7d000001001800 -> 5c7d000001000000 (not written)
idx=93 addr=0x100008368 size=8 657d000001001800 -> 657d000001000000 (not written)
idx=94 addr=0x100008380 size=8 6d7d000001001800 -> 6d7d000001000000 (not written)
idx=95 addr=0x100008398 size=8 747d000001001800 -> 747d000001000000 (not written)
idx=96 addr=0x1000083b0 size=8 7b7d000001001800 -> 7b7d000001000000 (not written)
idx=97 addr=0x1000083c8 size=8 827d000001001800 -> 827d000001000000 (not written)
idx=98 addr=0x1000083e0 size=8 937d000001001800 -> 937d000001000000 (not written)
idx=99 addr=0x1000083f8 size=8 a07d000001001800 -> a07d000001000000 (not written)
idx=100 addr=0x100008410 size=8 a97d000001001800 -> a97d000001000000 (not written)
idx=101 addr=0x100008428 size=8 b37d000001001800 -> b37d000001000000 (not written)
idx=102 addr=0x100008440 size=8 bf7d000001001800 -> bf7d000001000000 (not written)
idx=103 addr=0x100008458 size=8 cc7d000001001800 -> cc7d000001000000 (not written)
idx=104 addr=0x100008470 size=8 d97d000001001800 -> d97d000001000000 (not written)
idx=105 addr=0x100008488 size=8 e77d000001003000 -> e77d000001000000 (not written)
idx=106 addr=0x1000084b8 size=8 ed7d000001001800 -> ed7d000001000000 (not written)
idx=107 addr=0x1000084d0 size=8 fa7d000001001800 -> fa7d000001000000 (not written)
idx=108 addr=0x1000084e8 size=8 0c7e000001001800 -> 0c7e000001000000 (not written)
EOF
RUN

NAME=macho relocs bin.relocs.apply
BROKEN=1
FILE=bins/mach0/ls-m1
ARGS=-e bin.relocs.apply=true
CMDS=<<EOF
x 32 @ 0x1000081d8
wc
EOF
EXPECT=<<EOF
- offset -   D8D9 DADB DCDD DEDF E0E1 E2E3 E4E5 E6E7  89ABCDEF01234567
0x1000081d8  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x1000081e8  0000 0000 0000 0000 0000 0000 0000 0000  ................
EOF
RUN
