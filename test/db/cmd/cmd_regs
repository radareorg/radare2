NAME=debug register profile io plugin test
ARGS=-a x86 -b 32
FILE=reg://
CMDS=<<EOF
x 64 @ 0
dr eax = 123
x 64 @ 0
dr eip = 123
x 64 @ 0
EOF
EXPECT=<<EOF
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x00000010  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x00000020  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x00000030  0000 0000 0000 0000 0000 0000 0000 0000  ................
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x00000010  0000 0000 0000 0000 7b00 0000 0000 0000  ........{.......
0x00000020  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x00000030  0000 0000 0000 0000 0000 0000 0000 0000  ................
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
0x00000000  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x00000010  0000 0000 0000 0000 7b00 0000 0000 0000  ........{.......
0x00000020  0000 0000 0000 0000 0000 0000 0000 0000  ................
0x00000030  7b00 0000 0000 0000 0000 0000 0000 0000  {...............
EOF
RUN

NAME=map flags in reg://
ARGS=-a x86 -b 32
FILE=reg://
CMDS=<<EOF
.drp*
dr eax = 123
dr eip = 123
xa 64 @ 0
EOF
EXPECT=<<EOF
- offset -   0 1  2 3  4 5  6 7  8 9  A B  C D  E F  0123456789ABCDEF
            /e/gpr.bh /g/gpr.ch /g/gpr.dh /gpr.esi                 
0x00000000  0000 0000 0000 0000 0000 0000 0000 0000  ................
            /gpr.edi  /gpr.ebp  /g/gpr.ah                          
0x00000010  0000 0000 0000 0000 7b00 0000 0000 0000  ........{.......
                                          /gpr.oeax                
0x00000020  0000 0000 0000 0000 0000 0000 0000 0000  ................
            /gpr.eip                      /gpr.esp                 
0x00000030  7b00 0000 0000 0000 0000 0000 0000 0000  {...............
EOF
RUN

NAME=x87 80-bit float register test
ARGS=-a x86 -b 64
FILE=malloc://1024
CMDS=<<EOF
e asm.arch=x86
e asm.bits=64
.dr*
dr st0
EOF
EXPECT=<<EOF
0x00000000
EOF
RUN

